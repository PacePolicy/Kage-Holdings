<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Client Dashboard – Kage Holdings Company</title>
  <style>
    /* …same CSS as before… */
  </style>
</head>
<body>
  <header>
    <h1>Kage Holdings Company</h1>
    <p>Welcome, Finn JH Nakamura</p>
  </header>
  <div class="dashboard">
    <div class="card-container">
      <div class="card"><h3>Total Portfolio Value</h3><p id="totalPortfolioValue">Loading…</p></div>
      <div class="card"><h3>Funds Available</h3><p>$150.00</p></div>
      <div class="card"><h3>Amount Invested</h3><p id="amountInvested">Loading…</p></div>
      <div class="card"><h3>Net Gain/Loss</h3><p id="netGainLoss">Loading…</p></div>
    </div>
    <div class="actions">
      <button class="wide-button">View Investments</button>
    </div>
    <section>
      <h2>My Investments</h2>
      <table id="investmentTable"><thead>
        <tr><th>Ticker</th><th>Status</th><th>Date</th><th>Market Value</th><th># of Shares</th><th>Net Value</th><th>Net Gain</th></tr>
      </thead><tbody></tbody></table>
    </section>
  </div>

  <script>
    // 1) helper: parse CSV text into array of objects
    function parseCSV(text) {
      const [headerLine, ...lines] = text.trim().split('\n');
      const headers = headerLine.split(',').map(h=>h.replace(/(^"|"$)/g,''));
      return lines.map(line => {
        const values = line.split(',');
        const obj = {};
        headers.forEach((h,i)=> obj[h] = values[i].replace(/(^"|"$)/g,''));
        return obj;
      });
    }

    // 2) fetch the CSV and render
    fetch('https://docs.google.com/spreadsheets/d/1odEA07QgnExb6a-3zi2zQO2tA5k1RbhBGyFZKcf8J28/pub?output=csv')
      .then(r => r.text())
      .then(csvText => {
        const rows = parseCSV(csvText);

        // assume row 9 (index 8) holds the summary cells
        const summary = rows[8];
        document.getElementById('totalPortfolioValue').innerText = `$${summary['L9']}`;
        document.getElementById('amountInvested').innerText = `$${summary['E9']}`;
        document.getElementById('netGainLoss').innerText = `$${summary['M9']}`;

        // populate table
        const tbody = document.querySelector('#investmentTable tbody');
        rows.forEach(r => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${r['Ticker:']}</td>
            <td>${r['Status']}</td>
            <td>${r['Date:']}</td>
            <td>${r['Market Value:']}</td>
            <td>${r['# of shares:']}</td>
            <td>${r['Net Value:']}</td>
            <td>${r['Net Gain:']}</td>
          `;
          tbody.appendChild(tr);
        });
      })
      .catch(err => console.error('Error loading sheet:', err));
  </script>
</body>
</html>
